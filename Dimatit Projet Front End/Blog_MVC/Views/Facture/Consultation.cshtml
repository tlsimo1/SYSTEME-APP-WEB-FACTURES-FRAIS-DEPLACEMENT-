<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="card">
                    <div class="card-body">

                        <div class="row">
                            <input type="hidden" class="form-control" id="txt_id" />
                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Numéro Facture</label>
                                    <input id="txt_numerofacture" class="form-control">
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Fournisseur</label>
                                    <input id="txt_fournissuer" type="text" class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>

                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Date Facture</label>
                                    <div class="input-group date" id="datepickerDateFacture01">
                                        <input type="text" value="" id="txt_dateFacture01" class="form-control" />
                                        <span class="input-group-append">
                                            <span class="input-group-text bg-white d-block">
                                                <i class="fa fa-calendar"></i>
                                            </span>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Date de Saisie</label>
                                    <input id="txt_dateSaisie" type="text" readonly class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Total TTC</label>
                                    <input id="txt_totalttc" type="text" class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>


                        </div>
                    </div>
                </div>
                <div class="modal-footer">

                    <button type="button" class="btn btn-primary" id="btnUpdate" onclick="UpdteFacture();">Update</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>

                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade " id="exampleModalDetail" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">
                    Détail

                </h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="card">
                    <div class="card-body">
                        <div class="row">
                            <input type="hidden" class="form-control" id="txt_id" />
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label>Numéro Facture</label>
                                    <input id="txt_numerofacture01" readonly class="form-control">
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label>Fournisseur</label>
                                    <input id="txt_fournissuer01" readonly type="text" class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <div class="form-group">
                                        <label>Date Facture</label>
                                        <input id="txt_dteFac01" type="text" readonly class="form-control" aria-label="Date de Saisie">
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label>Total TTC</label>
                                    <input id="txt_totalttc01" type="text" readonly class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label>Statut Bureau D'ordre</label>
                                    <input id="txt_Statutbdr" type="text" readonly class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>

                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label>Date Saisi Bureau D'ordre </label>
                                    <input id="dte_bdr" type="text" readonly class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label>Statut Assistante DAF</label>
                                    <input id="txt_statutAss" readonly type="text" class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>

                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label>Date Saisi Assistante DAF</label>
                                    <input id="dte_Ass" type="text" readonly class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label>Statut Chef Comptable</label>
                                    <input id="txt_statutchef" readonly type="text" class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>

                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label>Date Saisi Chef Comptable</label>
                                    <input id="dte_chef" readonly type="text" class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label>Statut Comptablité</label>
                                    <input id="txt_cmp" readonly type="text" class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>

                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label>Date Saisi Comptabilité</label>
                                    <input id="dte_cmp" readonly type="text" class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label>Statut Achat</label>
                                    <input id="txt_statutachat" readonly type="text" class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>


                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label>Date Saisi Achat</label>
                                    <input id="dte_achat" readonly type="text" class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label>Statut Comptabilisation</label>
                                    <input id="txt_statutcomptabilisation" readonly type="text" class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label>Date Saisi Comptabilisation</label>
                                    <input id="dte_comptabilisation" readonly type="text" class="form-control" aria-label="Date de Saisie">
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h2>Consultation Facture</h2>
    </div>
    <div class="card-body">
        <div class="card-title">
            <a class="btn btn-outline-primary" onclick="GetEtat()">
                Print Facture
            </a>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <table class="stripe row-border order-column" id="FactureTable">
                    <thead>
                        <tr>


                            <th>Numero Facture</th>
                            <th>Fournisseur</th>
                            <th>Date Facture</th>

                            <th>Total TTC</th>
                            <th>Bureau D'ordre Statut</th>
                            <th>Date Saisie</th>

                            <th>Assitante DAF Statut</th>
                            <th>dateDaf</th>

                            <th>Statut Chef Comptable</th>
                            <th>Date Saisie</th>

                            <th>Statut Comptabilité</th>
                            <th>Date Saisie</th>

                            <th>statut Achat</th>
                            <th>Date Saisie</th>

                            <th>Statut Comptabilisation</th>
                            <th>Date Comptabilisation</th>

                            <th>Action</th>

                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/2.0.5/css/dataTables.dataTables.min.css" />
<script type="text/javascript" charset="utf-8" src="https://cdn.datatables.net/2.0.5/js/dataTables.min.js"></script>
<script type="text/javascript">
    var js = jQuery.noConflict(true);
    var date = new Date();
    var dateSaisie;
    //date = new Date(date);
    date = ((date.getDate() > 9) ? date.getDate() : ('0' + date.getDate())) + '/' +
        ((date.getMonth() > 8) ? (date.getMonth() + 1) : ('0' + (date.getMonth() + 1)))
        + '/' + date.getFullYear();
    //<input type="text" value = "today();" id = "datepicker" />
    js(document).ready(function () {
        js('#txt_dateFacture').val(date);
        js('#datepickerDateFacture01').datepicker({
            format: 'dd/mm/yyyy',
            "setDate": new Date(),
            "autoclose": true
        });
        LaodFacture();
    });
    function LaodFacture() {

        tableData = [];
        $.ajax({
            type: 'GET',
            url: 'https://localhost:7146/api/Facture/GetAllFacture',
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            async: false,
            headers: {
                'Authorization': 'Bearer '
                    + sessionStorage.getItem("token")
            },
            success: function (data) {

                $.each(data, function (key, value) {
                    var _edit = "<a class='btn btn-primary' onclick='FunEdit(this)'>Edit</a>"
                    var _remove = "<a class='btn btn-danger' onclick='FunRemove(this)'>Remove</a>"
                    var _View = "<a class='btn btn-secondary' onclick='View(this)'>Détail</a>"
                    var _hddn = "<input type='hidden' id='hddenID' value=" + value.iD_facture + " >"
                    var _action = _hddn + _edit + " | " + _View + " | " + _remove;



                    var dateFacture = new Date(value.date_Facture);
                    dateFacture = ((dateFacture.getDate() > 9) ? dateFacture.getDate() : ('0' + dateFacture.getDate())) + '/' +
                        ((dateFacture.getMonth() > 8) ? (dateFacture.getMonth() + 1) : ('0' + (dateFacture.getMonth() + 1)))
                        + '/' + dateFacture.getFullYear();
                        var dateSaisi = new Date(value.date_Saisie);
                    dateSaisi = ((dateSaisi.getDate() > 9) ? dateSaisi.getDate() : ('0' + dateSaisi.getDate())) + '/' +
                        ((dateSaisi.getMonth() > 8) ? (dateSaisi.getMonth() + 1) : ('0' + (dateSaisi.getMonth() + 1)))
                        + '/' + dateSaisi.getFullYear();

                    var dateCmp = new Date(value.datecmp);
                    dateCmp = ((dateCmp.getDate() > 9) ? dateCmp.getDate() : ('0' + dateCmp.getDate())) + '/' +
                        ((dateCmp.getMonth() > 8) ? (dateCmp.getMonth() + 1) : ('0' + (dateCmp.getMonth() + 1)))
                        + '/' + dateCmp.getFullYear();

                    var dateComptabilisation = new Date(value.dateComptabilisation);
                    dateComptabilisation = ((dateComptabilisation.getDate() > 9) ? dateComptabilisation.getDate() : ('0' + dateComptabilisation.getDate())) + '/' +
                        ((dateComptabilisation.getMonth() > 8) ? (dateComptabilisation.getMonth() + 1) : ('0' + (dateComptabilisation.getMonth() + 1)))
                        + '/' + dateComptabilisation.getFullYear();

                    var datehef = new Date(value.dateChef);
                    datehef = ((datehef.getDate() > 9) ? datehef.getDate() : ('0' + datehef.getDate())) + '/' +
                        ((datehef.getMonth() > 8) ? (datehef.getMonth() + 1) : ('0' + (datehef.getMonth() + 1)))
                        + '/' + datehef.getFullYear();

                    var dateSaisiDAF = new Date(value.dateDaf);
                    dateSaisiDAF = ((dateSaisiDAF.getDate() > 9) ? dateSaisiDAF.getDate() : ('0' + dateSaisiDAF.getDate())) + '/' +
                        ((dateSaisiDAF.getMonth() > 8) ? (dateSaisiDAF.getMonth() + 1) : ('0' + (dateSaisiDAF.getMonth() + 1)))
                        + '/' + dateSaisiDAF.getFullYear();

                    var dateAchat = new Date(value.dateAchat);
                    dateAchat = ((dateAchat.getDate() > 9) ? dateAchat.getDate() : ('0' + dateAchat.getDate())) + '/' +
                        ((dateAchat.getMonth() > 8) ? (dateAchat.getMonth() + 1) : ('0' + (dateAchat.getMonth() + 1)))
                        + '/' + dateAchat.getFullYear();

                    tableData.push([


                        value.numFacture,
                        value.fournisseur,
                        dateFacture,

                        value.totalTTC,
                        value.statut_BureauOrdre,
                        dateSaisi,

                        value.statut_AssitanteDAF,
                        dateSaisiDAF,
                        value.statut_ChefComptable,

                        datehef,
                        value.statut_Comptabilite,
                        dateCmp,

                        value.statut_Achat,
                        dateAchat,
                        value.statut_Comptabilisation,
                        dateComptabilisation,
                        _action
                    ]);

                })
            },
            complete: function (xhr) {
                if (xhr.status == "401") {
                    location.href = '@Url.Action("LogIn", "LogIn")';
                }
                // else {
                //     location.href = '@Url.Action("PageNotFound", "LogIn")';
                // }
            },
            faileur: function (error) {
            }
        })
        js('#FactureTable').DataTable({
            columnDefs: [{ width: 220, targets: 16 }],
            data: tableData,
            "scrollX": true,
            "bDestroy": true
           

        })
    }
    function FunEdit(element) {


        var id = $(element).closest('tr').find('#hddenID ').val();
        //alert(id);
        //var _matricule = $('#txt_Matricule');
        //_matricule.css('border-color', '');
        //var _nom = $('#txt_Nom');
        //_nom.css('border-color', '')
        //var id = $('#txt_id').val();
        // if (id=!null && id=!'')
        // {
        $.ajax({
            type: 'GET',
            url: 'https://localhost:7146/api/Facture/GetDetailFacture?id=' + id,
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            async: false,
            headers: {
                'Authorization': 'Bearer '
                    + sessionStorage.getItem("token")
            },
            success: function (data) {
                //alert(data)
                $.each(data, function (key, value) {

                    var dateFacture = new Date(value.date_Facture);
                    dateFacture = ((dateFacture.getDate() > 9) ? dateFacture.getDate() : ('0' + dateFacture.getDate())) + '/' +
                        ((dateFacture.getMonth() > 8) ? (dateFacture.getMonth() + 1) : ('0' + (dateFacture.getMonth() + 1)))
                        + '/' + dateFacture.getFullYear();

                    var dateSaisi = new Date(value.date_Saisie);
                    dateSaisi = ((dateSaisi.getDate() > 9) ? dateSaisi.getDate() : ('0' + dateSaisi.getDate())) + '/' +
                        ((dateSaisi.getMonth() > 8) ? (dateSaisi.getMonth() + 1) : ('0' + (dateSaisi.getMonth() + 1)))
                        + '/' + dateSaisi.getFullYear();

                    $('#txt_id').val(value.iD_facture);
                    $("#exampleModalLabel").text("Update");
                    $('#txt_numerofacture').val(value.numFacture);
                    $('#txt_fournissuer').val(value.fournisseur);
                    $('#txt_dateFacture01').val(dateFacture);
                    $('#txt_dateSaisie').val(dateSaisi);
                    $('#txt_totalttc').val(value.totalTTC);
                    $('#exampleModal').modal('show');
                })

            },
            faileur: function (error) {
            }
        })

    }

    function UpdteFacture() {
  
        var todayDate = new Date().toISOString().slice(0, 10);
        var _isproceed = true;
        var id = $('#txt_id').val();
        
        var _numerofacture = $('#txt_numerofacture');
        var _fournissuer = $('#txt_fournissuer');
        var _dateFacture = $('#txt_dateFacture01');

        var _dateSaisie = $('#txt_dateSaisie');
        var _totalttc = $('#txt_totalttc');

       

        //var _IdFrais= id;


        var id = $('#txt_id').val();

        var numerofacture = _numerofacture.val();
        var fournissuer = _fournissuer.val();
        var dateFacture = _dateFacture.val();
        var dateSaisie = _dateSaisie.val();
        var totalttc = _totalttc.val();

      

        if (numerofacture == null || numerofacture == '') {
            _numerofacture.css('border-color', 'red')
            _isproceed = false;
        }
        else {
            _numerofacture.css('border-color', '#ccc')
        }
        if (fournissuer == null || fournissuer == '') {
            _fournissuer.css('border-color', 'red')
            _isproceed = false;
        }
        else {
            _fournissuer.css('border-color', '#ccc')
        }
        if (dateFacture == null || dateFacture == '') {
            _dateFacture.css('border-color', 'red')
            _isproceed = false;
        }
        else {
            _dateFacture.css('border-color', '#ccc')
        }

        if (totalttc == null || totalttc == '') {
            _totalttc.css('border-color', 'red')
            _isproceed = false;
        }
        else {
            _totalttc.css('border-color', '#ccc')
        }

        var obj = new Object();
        obj.iD_facture = id;
        obj.numFacture = numerofacture;
        obj.fournisseur = fournissuer;
        obj.date_Facture = dateFacture.split("/").reverse().join("-");
        obj.date_Saisie = dateSaisie.split("/").reverse().join("-");
        obj.totalTTC = totalttc;

        


        if (_isproceed) {


            $.ajax({
                type: 'PUT',
                url: 'https://localhost:7146/api/Facture/UpdateFacture',
                contentType: "application/json;charset=utf-8",
                dataType: "json",
                data: JSON.stringify(obj),
                async: false,
                headers: {
                    'Authorization': 'Bearer '
                        + sessionStorage.getItem("token")
                },
                success: function (data) {
                    alert("Update successFuly");
                    LaodFacture();
                    $('#exampleModal').modal('hide');
                },
                faileur: function (error) {
                }
            })
        }

    }
    
    function FunRemove(element) {

        var id = $(element).closest('tr').find('#hddenID').val();
        if(confirm("voulez vous vraiment le supprimer "))
        {
            procedtoRemove(id);
        }
        
    }
    function procedtoRemove(id) {

        $.ajax({
            type: 'DELETE',
            url: 'https://localhost:7146/api/Facture/DeleteFacture?id=' + id,
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            async: false,
             headers: {
                'Authorization': 'Bearer '
                    + sessionStorage.getItem("token")
            },
            success: function () {
                // debugger
                // if (data.responseCode == 200) {
                LaodFacture();
                alert("Delete successFuly")
                // }
                // else
                // {
                //     alert("Failed to Save")
                // }
            },
            faileur: function (error) {
            }
        })
    }
    function View(element) {

        var numFacAss = $(element).closest('tr').find('#hddenID ').val();

        $.ajax({
            type: 'GET',
            url: 'https://localhost:7146/api/Facture/GetDetailFacture?id=' + numFacAss,
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            async: false,
             headers: {
                'Authorization': 'Bearer '
                    + sessionStorage.getItem("token")
            },
            success: function (data) {


                $.each(data, function (key, value) {

                    var dateFacture = new Date(value.date_Facture);
                    dateFacture = ((dateFacture.getDate() > 9) ? dateFacture.getDate() : ('0' + dateFacture.getDate())) + '/' +
                        ((dateFacture.getMonth() > 8) ? (dateFacture.getMonth() + 1) : ('0' + (dateFacture.getMonth() + 1)))
                        + '/' + dateFacture.getFullYear();

                    var dateSaisi = new Date(value.date_Saisie);
                    dateSaisi = ((dateSaisi.getDate() > 9) ? dateSaisi.getDate() : ('0' + dateSaisi.getDate())) + '/' +
                        ((dateSaisi.getMonth() > 8) ? (dateSaisi.getMonth() + 1) : ('0' + (dateSaisi.getMonth() + 1)))
                        + '/' + dateSaisi.getFullYear();

                    var dateCmp = new Date(value.datecmp);
                    dateCmp = ((dateCmp.getDate() > 9) ? dateCmp.getDate() : ('0' + dateCmp.getDate())) + '/' +
                        ((dateCmp.getMonth() > 8) ? (dateCmp.getMonth() + 1) : ('0' + (dateCmp.getMonth() + 1)))
                        + '/' + dateCmp.getFullYear();

                    var dateComptabilisation = new Date(value.dateComptabilisation);
                    dateComptabilisation = ((dateComptabilisation.getDate() > 9) ? dateComptabilisation.getDate() : ('0' + dateComptabilisation.getDate())) + '/' +
                        ((dateComptabilisation.getMonth() > 8) ? (dateComptabilisation.getMonth() + 1) : ('0' + (dateComptabilisation.getMonth() + 1)))
                        + '/' + dateComptabilisation.getFullYear();

                    var datehef = new Date(value.dateChef);
                    datehef = ((datehef.getDate() > 9) ? datehef.getDate() : ('0' + datehef.getDate())) + '/' +
                        ((datehef.getMonth() > 8) ? (datehef.getMonth() + 1) : ('0' + (datehef.getMonth() + 1)))
                        + '/' + datehef.getFullYear();

                    var dateSaisiDAF = new Date(value.dateDaf);
                    dateSaisiDAF = ((dateSaisiDAF.getDate() > 9) ? dateSaisiDAF.getDate() : ('0' + dateSaisiDAF.getDate())) + '/' +
                        ((dateSaisiDAF.getMonth() > 8) ? (dateSaisiDAF.getMonth() + 1) : ('0' + (dateSaisiDAF.getMonth() + 1)))
                        + '/' + dateSaisiDAF.getFullYear();

                    var dateAchat = new Date(value.dateAchat);
                    dateAchat = ((dateAchat.getDate() > 9) ? dateAchat.getDate() : ('0' + dateAchat.getDate())) + '/' +
                        ((dateAchat.getMonth() > 8) ? (dateAchat.getMonth() + 1) : ('0' + (dateAchat.getMonth() + 1)))
                        + '/' + dateAchat.getFullYear();
                    
                    $('#txt_id').val(value.iD_facture);
                    $("#exampleModalLabel").text("Détail Facture");
                    $('#txt_numerofacture01').val(value.numFacture);
                    $('#txt_fournissuer01').val(value.fournisseur);
                    $('#txt_dteFac01').val(dateFacture);
                    $('#txt_totalttc01').val(value.totalTTC);

                    $('#txt_Statutbdr').val(value.statut_BureauOrdre);
                    if (dateSaisi === '0001-01-01T00:00:00') {
                        $('#dte_bdr').val('NULL');
                    }
                    else {
                        $('#dte_bdr').val(dateSaisi);
                    }

                    $('#txt_statutAss').val(value.statut_AssitanteDAF);
                    if (value.dateDaf === '0001-01-01T00:00:00') {
                        $('#dte_Ass').val('NULL');
                    }
                    else {
                        $('#dte_Ass').val(dateSaisiDAF);
                    }

                    $('#txt_statutchef').val(value.statut_AssitanteDAF);


                    if (value.dateChef === '0001-01-01T00:00:00') {
                        $('#dte_chef').val('NULL');
                    }
                    else {
                        $('#dte_chef').val(datehef);
                    }

                    $('#txt_cmp').val(value.statut_Comptabilite);
                    if (value.datecmp === '0001-01-01T00:00:00') {
                        $('#dte_cmp').val('NULL');
                    }
                    else {
                        $('#dte_cmp').val(dateCmp);
                    }

                    $('#txt_statutachat').val(value.statut_Achat);
                    if (value.dateAchat === '0001-01-01T00:00:00') {
                        $('#dte_achat').val('NULL');
                    }
                    else {
                        $('#dte_achat').val(dateAchat);
                    }
                    $('#txt_statutcomptabilisation').val(value.statut_Comptabilisation);

                    if (value.dateComptabilisation === '0001-01-01T00:00:00') {
                        $('#dte_comptabilisation').val('NULL');
                    }
                    else {
                        $('#dte_comptabilisation').val(dateComptabilisation);
                    }
                    $('#exampleModalDetail').modal('show');
                })
            },
            faileur: function (error) {
            }
        })

    }
    function GetEtat()
    {
        var date = new Date();
        date =
            ((date.getMonth() > 8) ? (date.getMonth() + 1) : ('0' + (date.getMonth() + 1)))
             

            + '/' +
            ((date.getDate() > 9) ? date.getDate() : ('0' + date.getDate()))
           
            + '/' + 
            date.getFullYear();

        $.ajax({
            type: 'GET',
            url: 'https://localhost:7146/api/Facture/GetEtat?date=' + date,
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            async: false,
            headers: {
                'Authorization': 'Bearer '
                    + sessionStorage.getItem("token")
            },
            success: function (data) {
              $.ajax({
                        type: 'POST',
                        url: 'https://localhost:7180/Etats/Index',
                        contentType: "application/json;charset=utf-8",
                        dataType: "json",
                        data: JSON.stringify(data),
                        async: false,
                        success: function (data) {
                        
                        },
                        faileur: function (error) {
                        }
                    })
                GeneratePDFFacture();
            },
            faileur: function (error) {
            }
        })
    }
    function GeneratePDFFacture() {
        location.href = '@Url.Action("GenerateRDLC_EtatFacture", "Etats")';
    }
</script>