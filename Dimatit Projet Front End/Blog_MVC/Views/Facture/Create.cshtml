
<div class=" ">
    @*<div class="mx-auto" style="width: 200px">Bureau D'ordre</div>*@

    <div class="m-5 pb-5 ">
        <div class="row m-5">
            <div class="col">
                <label>Numéro de Facture</label>
                <input type="text" id="numFacture" class="form-control" placeholder="Numéro de Facture" aria-label="Numéro de Facture">
            </div>
            <div class="col">

                <div class="form-group">
                    <label>Date Facture</label>
                    <div class="input-group date" id="datepickerDateFacture">
                        <input type="text" value="" id="txt_dateFacture" class="form-control" />
                        <span class="input-group-append">
                            <span class="input-group-text bg-white d-block">
                                <i class="fa fa-calendar"></i>
                            </span>
                        </span>
                    </div>
                </div>
                @*<input type="text" id="NumFacture" class="form-control" placeholder="Date de Facture" aria-label="Date de Facture">*@
            </div>
        </div>
        <div class="row m-5">
            <div class="col">
                <label>Fournisseur</label>
                <input id="txt_fournissuer" type="text" class="form-control" placeholder="Fournisseur" aria-label="Fournisseur">
            </div>
            <div class="col">
                <label>Date de Saisie</label>
                <input id="txt_dateSaisie" type="text" class="form-control" readonly   aria-label="Date de Saisie">
            </div>
        </div>
        <div class="row m-5">
            <div class="col">
                <label>Total TTC</label>
                <input id="txt_totalTTC" type="text" class="form-control" placeholder="Total TTC" aria-label="Total TTC">
            </div>
            <div class="col">
                <label></label>
                <div class=" d-flex justify-content-end">
                    <button type="button" style="width: 200px" onclick="AddFacture()" class="btn btn-outline-primary">Valider</button>
                    <button type="button" style="width: 100px ;margin-left: 5px;" class="btn btn-outline-secondary">Annuler</button>
                </div>
                
                
                
            </div>
        </div>
    </div>

    @*<div class="container vh-100 d-flex justify-content-center align-items-center">
    <div class="row">
    <div class="col">
    <input type="text" class="form-control" placeholder="First name" aria-label="First name">
    </div>
    <div class="col">
    <input type="text" class="form-control" placeholder="Last name" aria-label="Last name">
    </div>
    </div>
    </div>*@

    @*<div class="col">
    <div class="d-flex align-items-center flex-direction-column justify-content-center   border p-3">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTtRAI0DozVRaWKStSuxNvFECLt484KOYdjgA&usqp=CAU" alt="title"
    class="flex-shrink-0 mb-3 rounded-circle" style="width:60px;height:60px;">
    <div class="">
    <h6><a class="text-decoration-none text-primary" href="#">

    <div class="col">
    <input type="text" class="form-control" placeholder="First name" aria-label="First name">
    </div>
    <div class="col">
    <input type="text" class="form-control" placeholder="Last name" aria-label="Last name">
    </div>

    </a></h6>
    </div>
    </div>*@


</div>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>

@*<script src="~/lib/jquery/dist/jquery.min.js"></script>*@

<script type="text/javascript">

    var todayDate = new Date().toISOString().slice(0, 10);
    var js = jQuery.noConflict(true);
    var valueSelected;
    var idPersonnel;
    var date = new Date();
    var dateSaisie;
    //date = new Date(date);
    date = ((date.getDate() > 9) ? date.getDate() : ('0' + date.getDate())) + '/' +
        ((date.getMonth() > 8) ? (date.getMonth() + 1) : ('0' + (date.getMonth() + 1)))
        + '/' + date.getFullYear();
    //<input type="text" value = "today();" id = "datepicker" />
    js(document).ready(function () {
        js('#txt_dateFacture').val(date);
        js('#datepickerDateFacture').datepicker({
            format: 'dd/mm/yyyy',
            "setDate": new Date(),
            "autoclose": true
        });
        js('#txt_dateSaisie').val(date);
    });
    function AddFacture()
    {
        var _isproceed = true;
        var _numFacture = $('#numFacture');
        var _dateFacture = $('#txt_dateFacture');
        var _fournissuer = $('#txt_fournissuer');
        var _dateSaisie = $('#txt_dateSaisie');
        var _totalTTC = $('#txt_totalTTC');

        var numFacture = _numFacture.val();
        var dateFacture = _dateFacture.val();
        var fournissuer = _fournissuer.val();
        var dateSaisie = date;
        var totalTTC = _totalTTC.val();
        
        if (numFacture == null || numFacture == '') {
            _numFacture.css('border-color', 'red')
            _isproceed = false;
        }
        else {
            _numFacture.css('border-color', '#ccc')
        }
        if (fournissuer == null || fournissuer == '') {
            _fournissuer.css('border-color', 'red')
            _isproceed = false;
        }
        else {
            _fournissuer.css('border-color', '#ccc')
        }
        if (totalTTC == null || totalTTC == '') {
            _totalTTC.css('border-color', 'red')
            _isproceed = false;
        }
        else {
            _totalTTC.css('border-color', '#ccc')
        }
        if (_isproceed) {

            var obj=new Object();
            obj.iD_facture=0;
            obj.numFacture = numFacture;
            obj.fournisseur = fournissuer;
            obj.date_Facture = dateFacture.split("/").reverse().join("-");
            obj.date_Saisie = date.split("/").reverse().join("-");
            obj.totalTTC =totalTTC;

            $.ajax({
                type: 'POST',
                url: 'https://localhost:7146/api/Facture/CreateFacture',
                contentType: "application/json;charset=utf-8",
                dataType: "json",
                data: JSON.stringify(obj),
                async: false,
                headers: {
                    'Authorization': 'Bearer '
                        + sessionStorage.getItem("token")
                },
                success: function (data) {
                    clearTextBox();
                    alert('facture ajoutée')
                },
                faileur: function (error) {
                }
            })

        }
    }
    function clearTextBox() {
        var _numFacture = $('#numFacture');
        _numFacture.css('border-color', '');

        var _fournissuer = $('#txt_fournissuer');
        _fournissuer.css('border-color', '')

        var _totalTTC = $('#txt_totalTTC');
        _totalTTC.css('border-color', '')
        
        $('#numFacture').val("");
        $('#txt_dateFacture').val("");
        $('#txt_fournissuer').val("");
        $('#txt_totalTTC').val("");
       
    }
</script>
